# 计算机组成原理

前置课程是数字电路（数字逻辑）等专业课，同时它也是计算机科学专业中唯一一门直接和硬件逻辑实现相关的课程，是计算机课程体系中硬件系列课程的基础。

对象：数字电子计算机

组成：计算机硬件系统的逻辑实现，即数字电路层面的逻辑门和触发器来实现计算机硬件系统，不是物理实现

原理：数字电子计算机硬件系统逻辑实现的一般原理，不依托任何具体机型

基本部件的结构和组织方式，用数字电路中的知识对计算机的基本部件进行逻辑实现。

基本运算的操作原理，数学运算在计算机中的实现原理，用数字电路知识实现这些电路

基本部件和基本单元的设计思想，基本部件之间的相互组织协调

实现一个计算机的逻辑设计，实现一个具体机型的逻辑实现，可以完成一个具体的处理器的逻辑设计

先给出整个计算机硬件系统的全貌，然后逐渐细化直到最底层组件的逻辑实现

推荐教材：

- 计算机组成原理（唐朔飞）
- 计算组成与设计：硬件\软件结构
- 数字设计与计算机体系结构

**计算机组成原理在计算机专业课程体系中的位置**

![image-20220922212930368](..\images\image-20220922212930368.png)

指令集体系结构：计算机软硬件系统的一个交接处（学自计算机体系结构）。

进程，处理器和 I/O 以及数据通路和控制：都是在计算机组成原理中需要学习的。

硬件的直接上层就是计算机组成原理，软硬件之间的是计算机体系结构，而计算机组成原理的直接上层是计算机体系结构。

计算机组成原理：重点讲如何实现，实现的细节。

计算机体系结构：是采用分析加上评测的方式，来说明为什么在计算机系统设计中要这样设计。

> 比如 cache 是计算机系统中非常重要的一个部件，它大大提升计算机系统的速度，特别是对内存中的数据和指令的存取速度，cache 有多种组织方式，比如组相联，直接相联和全相联，其中在组相联中又有两路组相联，四路组相联，八路组相联。假如选择了组相联这种方式对 cache 进行组织，那么我们设计的计算机系统适合两路组相联，四路组相联，八路组相联中的哪种，就需要分析加评测。
>
> 比如一条指令是否引入到我们的计算机的指令集中，也采用分析加评测的方式来确定引入的优势和不引入的劣势，以及是否引入到设计的计算机系统中。 一旦该指令被确定引入系统中，那么计算机组成层面给就要确认用什么样的方式（逻辑电路）来实现该指令。

## 概论

计算机系统硬件概貌以及程序在计算机中如何执行。

## 计算机系统的硬件结构

- 系统总线

- 存储器

- I/O

- 数据的表示

- 数据的运算方法和运算器

  ![image-20220922214153675](..\images\image-20220922214153675.png)

## CPU

- 指令系统
- ALU
- CU
- CPU 以及内部互联
- 寄存器

## CU（控制单元）

- 排队逻辑
- 寄存器和解码器
- 控制器
- 存储器

对指令的微观操作进行分析，用两种方式实现计算机中的控制器，一种是硬连方式，另一种是微程序设计的方式。

## 计算机系统概论

计算机系统构成部分：

- 硬件
- 软件

物联网：把各种传感器嵌入到设备中，感知设备的状态，将接受到的数据传给后台系统，进行分析处理。

## 第一节摘要

计算机组成原理在计算机专业的课程体系当中是非常重要的一门课这门课是计算机专业的核心课程,是基础课程数字逻辑设计数字电子技术等课程

这门课程为什么这么重要因为这门课程是计算机专业的课程体系当中唯一的一门讲授计算机硬件的逻辑实现的课程是计算机课程体系当中硬件系列课程的上层

讲授的内容这门课程的名称上面有三个关键词第一个关键词就是计算机在计算机的发展历史上曾经出现过多种类型的计算机比如说机械式的计算机模拟电子计算机数字电子计算机那么现在的计算机几乎都是数字电子计算机因此这门课的内容就是围绕着数字电子计算机展开的

第二个关键词就是组成（organization、组织）那么什么是组成组成是指计算机硬件系统的逻辑实现，不是物理实现那么什么是计算机硬件系统的逻辑实现用数字电路，数字逻辑的知识以及学过的门电路、触发器等数字电子的元器件来实现计算机的硬件系统

第三个关键词是原理讲授数字电子计算机硬件系统逻辑实现的一般原理，不依托任何具体机型是指在计算机发展过程当中，多种数字电子计算机实现的公共的原理

讲授的内容主要分以下三大部分第一部分基本部件的结构和组织方式用我们学过的数字逻辑的知识数字电子的知识对计算机的基本部件进行逻辑实现

第二块重要的内容是基本运算的操作原理计算机的基本功能就是实现加、减、乘、除等运算的这些功能这些运算在计算机当中是如何实现的如何用数字电路的知识来实现这些运算的硬件电路

第三部分就是基本部件和基本单元的一些设计思想，还有一部分内容就是怎么把这些部件连接起来成为一个能够协调运行的一个整体的一个系统

这门课程的特色是要讲授计算机组成的一般原理不以具体机型为依托这样做的好处是将来大家在设计计算机的时候是对计算机进行逻辑设计的时候可以不受任何具体机型具体实现方式的这个制约创新性的或者自主性的完成这个系统的设计

这种讲法也有一定的问题感觉可能比较空因为没有实现一个计算机的逻辑设计

那么为了解决这个问题给大家推荐了两本教材那么这些教材里面都有具体机型的逻辑实现甚至根据这些教材，可以设计完成一个具体的处理器的逻辑设计

通过这种方式实现这个课程的落地

另外这个课程的组织采用的是自顶向下的方式进行层层细化首先给出整个计算机硬件系统的这个概念然后逐渐的进行细化最后完成最底层的部件的逻辑实现从而完成整个计算机硬件系统的逻辑实现

教材：计算机组成原理（唐朔飞） 以及 配到练习册

推荐的两本参考教材

教材的名称是计算机组织与设计硬软件接口技术 risk 它指的是精简指令集计算机

第二本教材叫做数字设计和计算机体系结构这本教材分了两部分前一部分的内容是关于数字设计的那么讲了数字电路的基本知识和基本设计方法并且给出了两种硬件描述语言来描述数字设计

第二部分计算机体系结构的这一部分实际上讲授的是 mips 处理器它的逻辑实现讲的非常的清晰

看一下课程在课程体系当中的重要地位

这个图在计算机课程体系当中非常重要的一个图

![image-20230630203102458](..\images\image-20230630203102458.png)

现代计算机专业它的课程体系呢就是根据这个图进行设置的中间蓝色的部分是指令集体系结构也就是计算机软硬件系统的一个交界面那这部分内容是计算机体系结构课程要学的

那在它的下一层就是计算机组成原理要学的一些内容比如说处理器 memory，还有 database

右侧这个蓝色的图在这个图当中硬件的最上层就是计算机组成原理软硬件之间的这个交界面就是计算机体系结构课程那么这两门课它的内容上是有很大的区别的

计算机组成原理讲如何实现想实现的细节

计算机系统结构呢我们是采用分析加评测的方式来说明为什么在计算机系统设计当中要进行这样的一个设计比如说 cache 是计算机系统当中非常重要的一个部件，大大提升了计算机系统的速度特别是对内存当中数据和指令的存取速度那么 cache 有多种组织方式比如说组相连直相连和全相连

那么在组相连当中又有两路组相连四路组相连

假如说选择了组相连这种方式对开始进行组织到底哪一种相连方式适合我们这个计算机系统的设计那我们就要采用分析加评测的方式

另外比如说我们要确定一条指令是否要把它引入到计算机的指令集当中也要采用分析家评测的方式来确定把这条指令引入到计算机当中会给我们带来什么好处也会给我们带来什么问题从而确定是否把这条指令引入到系统当中

一旦这条指令被引入到系统当中了那么计算机组成这门课或者是计算机组成的设计人员那就要确认用什么样的方式来实现这条指令

这个课程的组织

![image-20230630203429575](..\images\image-20230630203429575.png)

我们这个课程的组织是采用自顶向下的方式进行层层细化所以这门课程的组织呢一共分成了四篇

第一篇是计算机系统概论我们给出计算机系统硬件的概念以及程序在计算机系统当中是如何执行的

第二篇就是计算机系统的硬件结构比如说存储器,i\o,系统总线

cpu 是计算机系统的核心是计算机系统当中非常重要的部件那为了把 cpu 讲清楚啊写清楚那我们在此基础上对 cpu 专门用一篇来进行描述 cpu 中的核心部件包括 alu，cu，cpu 内部的互联以及各种类型的寄存器

CU 是真个计算机的控制核心，也是计算机系统当中最重要的部分 CU 独立出来讲解主要介绍排队逻辑、寄存器、解码器、存储控制等等这几部分内容

我们对指令的微操作进行分析然后用两种方式来实现计算机的控制器或者 cpu 当中的控制器一种方式呢就是采用硬联方式另外一种方式是采用微程序设计的方式来完成计算机的设计

这个课程一共分成三大部分第一部分就是计算机组成原理之机器计算机系统的基本概念将在第一章进行介绍第三章我们介绍总线第四章我们介绍存储器第五章我们介绍输入输出系统

第二大部分就是计算机组成原理之数字主要的内容就是我们的第六章要讲授计算机当中数据的表示数据的基本运算方法以及实现这些运算方法的运算器

第三大部分讲授计算机组成原理的 cpu 主要就是指第七章第八章第九章和第十章第七章就是指令系统我们会进行一个简要的介绍因为指令系统呢是计算机系统结构或者计算机体系结构的课程当中要讲的主要的内容那第八章我们会介绍 cpu 的结构和功能在此基础上在第九章、第十章介绍控制单元和控制单元的设计

## 第二节摘要

开始第一章内容的讲解计算机系统概论第一章一共分三节首先我们对计算机系统做一个简介然后介绍计算机系统的基本组成最后简要给出计算机硬件的一些技术指标

第一个问题现代计算机系统是由哪两部分组成的（硬件和软件）

什么是物联网就是把传感器嵌入到设备当中比如说把它嵌入到电网铁路桥梁隧道公路等

为什么要把传感器嵌入到这些设备当中去? 就是让传感器在这些设备当中能够感知设备的状态然后把感知到的信息传送到后台的计算机或者是服务器当中后台的计算机和服务器根据感知到的状态对系统的健康状态,工作状态等进行判断

各种物体实际上通过网络形成了普遍的连接就形成了所谓的物联网

这些物联网在和传统的互联网进行整合进而实现人类社会和物理系统的整合那么形成智慧地球

那么如果说我们这个网络还有反馈能力的话比如说我们通过前端啊感知到信息通过后端进行信息处理并且根据信息处理的结果我们能够向前端啊进行信息反馈甚至根据处理结果由前端做出一些相应的这样的动作那这就形成了一个新的系统就是现在非常有名的信息物理系统

那么下面要回答计算机系统是由哪两大部分组成的

![image-20230630203536604](..\images\image-20230630203536604.png)

不管什么样的计算机对它进行顶层的抽象把计算机的结构进行简化然后再一步一步地进行细化

如果我们从最底层开始做起的话那这个系统呢都会非常的复杂甚至会感觉无处下手那实际上这些种类型的机器它的基本结构尽可能忽略这些计算机的一些具体的特征

可以把这个计算机系统给它分成两部分那么这两部分就是它的硬件和它的软件那么计算机的硬件就是指计算机的实体我们看得见摸得着的那些部分比如说主机,外设那么这些都是计算机系统的硬件

那么计算机系统另外的一大部分就是计算机系统的软件软件就是指由具有各类特殊功能的信息组成的软件看不见但是它是存储在计算机当中硬件通过软件来发挥作用硬件通过每一条指令的有序执行来发挥作用所以软件是计算机系统当中非常重要的一部分

但是我们这门课主要讲授的是计算机系统的硬件也就是说看得见摸得着的这些实体的逻辑实现

进一步对计算机软件进行分析计算机软件

那么计算机的软件进行分类的话分成大类啊可以分成两类

一类是计算机的系统软件一类是应用软件

![image-20230630203717520](..\images\image-20230630203717520.png)

早期的计算机呢是没有系统软件的那么后来为什么在计算机上增加了系统软件? 主要是通过计算机的系统软件方便用户对计算机系统的使用那么系统软件可以管理整个计算机系统管理计算机系统的硬件,软件给计算机的使用者提供人机的交界面

系统软件第一个语言处理程序高级语言程序想在计算机系统上运行的话必须有编译程序的支持经过编译链接以后的生成的这个目标程序可执行程序才能够在计算机的系统的硬件上去执行

另一个系统软件中最著名的就是操作系统管理计算机系统的软硬资源资源提供人机交互啊使多个用户，多个程序可以协调的在一台计算机上执行使用计算机系统的软硬件的资源

是服务性的程序数学库数据库管理系统

另外还有一些应用软件面向某一个特定的任务某一个特定的目标

## 第三节摘要

前面已经介绍了计算机系统是由硬件和软件两部分组成的

并且把软件部分进一步划分为系统软件和应用软件两部分

这种简单的划分并不能直接体现出软件和硬件之间的这种逻辑关系

我们可以用一个简单的层次结构来描述这种逻辑关系那下层是计算机系统的硬件硬件进行了相对的封装它为软件提供了接口比如说提供了指令集软件可以利用这些指令集编写能够完成一定功能的软件

那么进而软件我们又分成了应用软件和系统软件系统软件利用硬件提供的接口完成自己的功能比如说对系统当中的软硬件资源进行管理给用户提供人机交互界面

应用软件应用系统软件提供的接口调用系统软件的功能那么实现自己的功能

那么在这个层次结构当中把一个非常复杂的计算机系统用一个简单的层次结构来进行表述通过封装我们可以分层来实现一个复杂的计算机系统当然在分层过程当中要处理好各层之间的接口

用于处理系统复杂性的一个方法:抽象

抽象定义为对于一个过程或者是一件制品的某些细节,有目的的隐藏以便把其他方面细节或者是结构表达的更加清楚

维基百科把抽象定义为指更高级的模型或低级的与低级的实体相对

看到更高级的模型是指在抽象层次上更高更少的考虑实体或者是系统的实现细节那么底层的实体系统则更多地考虑了它的实现细节

抽象定义为隐藏系统当中不重要的细节那么一个系统我们可以从不同的角度去进行抽象比如说我们从物理构成的角度把计算机系统我们可以抽象成九层那么依据是每一层计算机它典型的构建模块最底层是物理抽象电子设备依靠电子的移动来工作我们可以用量子机制和麦克斯韦方程来描述电子的移动那么系统的工作是利用电子元件来完成的

在电子元件层利用电子在不同物质当中的移动特征来构建电子元件那这些电子元件体现出来的特征可以用连接点或者是管角它的电流和电压的特征进行描述

再上一层是模拟电路层利用下层的接口进一步的构建放大器滤波器等模拟电路部件那这些部件工作在连续的电压下

数字电路层利用模拟电路元件构建与门，非门

那么计算机组成原理这门课主要研究的是逻辑层和微体系结构层学习计算机中主要部件的逻辑实现和主要部件之间的链接来实现 data path 和控制

那前面我们讲的是一个从计算机物理结构的这个角度抽象出了九层：

<img src="..\images\image-20230630203851785.png" alt="image-20230630203851785" style="zoom:200%;" />

下面从程序员的视角对计算机系统的层次结构进行抽象根据计算机系统的发展最早出现的语言是机器语言那这个时候的机器就是实际的硬件的机器

编程人员利用机器提供的指令集使用机器语言也就是二进制代码直接对硬件机器进行编程编写完的程序在计算机系统当中在实际的硬件上直接进行执行

我们知道机器语言是由 01 代码构成的那这样的代码很难记忆很难使用为了简化程序的编写在此基础上呢人们又提出了利用汇编语言进行编程将机器语言符号化不直接使用 01 代码那么编程的难度进一步降低但实际上实际的机器或者硬件的机器并不能直接识别由汇编语言编写的程序汇编语言编写的程序要在机器上能够正确地运行起来的话那必须为这台机器提供汇编程序把汇编语言编写的程序转化成机器语言程序再在实际的计算机上跑那就相当于在实际的这个硬件的机器上我们外层又造了一层软件那这层软件完成了由汇编语言到机器语言的一个翻译但是汇编语言是符号语言和机器语言之间的对应关系基本上是一一对应的一条机器语言的指令那么对应了一条汇编语言的指令汇编编写起程序来依然比较复杂和人类的自然语言还有非常大的这个差距

那么后来人们又提出了高级语言利用高级语言进行编程那这个时候高级语言编写的程序要想在计算机上能够正确执行的话那我们必须要给高级语言提供编译程序或者是解释程序那由编译程序解释程序来生成我们的目标程序生成可执行代码在实际的机器上去执行那相当于在我们汇编语言的机器上外面我们又加了一层软件炸这台机器在高级语言程序员的眼中似乎就直接可以执行高级语言了那这是我们实际机器向上的这个发展

那么实际上我们这个机器还在向下发展一条机器语言指令执行过程也是很复杂的比如说要把这条机器语言的指令从存储器当中把它取出来要把这条指令的地址传送给存储器要告诉存储器呢进行读那么这条指令取出来以后要送给控制器进行译码，译码的结果再控制去操作数再完成相应的操作

所以这个执行过程也是非常复杂的而且呢这些操作之间是有先后关系的有些操作可以同时进行有些操作是有持续的必须等着其他操作做完或者是有些操作做完之后才能接续的去执行那么这样的话我们把一条机器指令给它继续的进行细化在每一个时间点上能够执行的那些操作我们把它放到一个微指令当中执行之间有先后顺序的那些操作我们把它放到不同的微指令当中通过微指令的执行顺序来控制这些操作之间的先后顺序那么这样的话对于利用微指令编写微程序来实现机器语言指令的这些程序员来说他所面对的指令就是一个微程序的机器这台机器呢能够执行微指令能够执行微程序进而实现对机器语言指令机器语言程序的操作运行

另一层就是操作系统汇编语言程序的程序员可以利用我们操作系统提供的功能进行编程那么操作系统呢可以管理软硬件的资源

从程序员的角度可以把计算机系统划分成五个层次

![image-20230630204108720](..\images\image-20230630204108720.png)

那么这五个层次

![image-20230630204146014](..\images\image-20230630204146014.png)

底层的微程序机器 m0 是由硬件来直接执行微指令微指令之间有一定的先后顺序多条微指令成了一个微程序 **一个微程序对应了一条机器指令**

那么实际机器这一层实际上是用微指令来解释机器指令

虚拟机 m2 是用机器语言来解释操作系统再上一层用汇编语言程序翻译成机器语言程序上一层用汇编程序翻译成机器语言程序那么这一层就是汇编语言程序员他所面对的这台机器啊用汇编程序完成这个翻译过程高级语言程序员面对的是高级语言程序用编译程序把它翻译成汇编语言程序逐层的往下送才能完成一条指令的执行进而完成一个程序的执行那么这个层次，有些是由硬件实现的那么有些是通过软件的方式实现的

我们把硬件和软件之间画上一条线

![image-20230630204533395](..\images\image-20230630204533395.png)

那么虚线下边这些层是真正的由硬件来实现的虚线上面这些层是由软件来实现的那么虚线这一部分对应的是计算机系统的软硬件的接口那这个接口也完成了计算机系统的功能的分配有一些功能是通过底层的硬件来实现的有一些功能通过上层的软件来实现

实际上一个功能是用硬件来实现还是用软件来实现在逻辑上是等价的不过如果用硬件实现的话会造成机器系统底层的硬件会比较复杂造价比较高设计周期比较长

那么如果用软件来实现那这个软件系统呢可能就会比较庞大

因为如果用硬件来做用一条指令就可以把它做完如果用软件实现的话需要指令集当中多条指令的组合才能完成这个功能那么这个软件它就会大一点运行的速度会慢一点这条线完成了计算机系统当中软硬件功能的划分也提供了软硬件的这个接口从程序员的角度把计算机划分成了五层那这个层次结构呢实际上也能够说明计算机系统结构这个概念它的定义

**要清楚计算机组成和计算机系统结构（计算机体系结构）从研究内容上到底有什么区别** 计算机系统结构定义了计算机系统的软硬件的交界面定义了哪些功能由软件来实现哪些功能由硬件来实现提供了上层软件进行编写的时候那么和硬件进行交互的接口那么从定义上讲计算机系统结构指的是程序员所看到的计算机系统的属性概念性结构和功能特性

比如说程序员程序员也有多种类型有机器语言程序员汇编语言程序员高级语言程序员

我们这个里边指的程序员就是机器语言程序员所见到的计算机系统的属性指什么呢就是指我们机器语言程序员要想编写一个能够在计算机硬件系统上正确执行的程序它所必须了解的计算机系统的属性比如说指令集，寄存器文件的组织，内存的编制单位以及指令集能够对哪些类型的数据进行操作那这些数据在专业术语上我们把它称为数据表示

那么计算机组成设计人员的是实现计算机体系结构所体现出来的这个属性比如说具体指令的实现例如在这个指令集当中有没有乘法指令能够对什么类型的数据做乘法操作数据的长度是多长这些内容都是在体系结构当中做的规定计算机组成的设计者则利用上面的规定来研究如何实现乘法指令那这个实现是指逻辑实现

这一节我们主要的讲解了这门课程的研究内容层次结构和应对系统复杂性的一个非常重要的方法，就是抽象的方法

## 第四节摘要

计算机的基本组成现在的计算机都是存储程序结构的计算机数据,程序都是以二进制的方式存放在计算机当中的这种结构的机器称为是冯诺依曼计算机

为什么称为冯诺依曼计算器因为这种结构是美籍匈牙利科学家冯诺依曼提出来的他提出了程序存储的思想并且成功地把这种思想运用在了计算机的设计当中那么我们把根据这一原理设计的机器都称为冯诺依曼结构的机器

冯诺依曼结构的计算机由五大组成部分组构成这五大组成部分都是什么我们现在用的机器就是冯诺依曼结构的机器存储程序型的计算机有运算器来实现各种类型的运算

那么到底要做什么运算有控制器来进行控制

冯诺依曼结构的机器是存储程序结构的机器指令和数据呢都存放在存储器当中有存储器

那么还有程序，数据要输入到计算机当中，有输入设备计算的结果要输出出来，有输出设备

冯诺依曼结构的计算机的五大组成部分运算器控制器存储器输入设备和输出设备

冯诺伊曼机的特点

冯诺依曼计算机的第一个特点就是这种结构的机器由五大部件组成

第二指令和数据是以同等的地位保存在存储器当中的要想对指令和数据加以利用的话就要访问存储器把指令和数据取出来那么访问数据是按地址进行访问的

第三指令和数据都是二进制数进行表示

第四指令由两部分构成操作码和地址码操作码指明了这条指令要做什么操作地址码指明了操作数所在的地址操作数在哪里在内存当中我们要根据这个地址把操作数取出来也可能在寄存器当中也要根据地址把操作数取出来

第五存储程序程序存放在存储器当中

第六以运算器为中心

冯诺依曼机器一共有六点特征那么核心特征就是我们现在的存储程序具有存储程序的这些特征的机器都称为冯诺依曼计算机

对每一个特点进行分析

比如说计算机由五大部件组成

如果涉及一台计算机是不是一定需要这五大部件

某些部件是不是可以结合在一起

举一个简单的例子,比如说算盘,这不是现代的计算机,但也是一个计算设备

那么算盘的五大部件

算盘它的运算器是那个算盘珠

控制器是人

如何对算盘珠进行操作

是由我们人来确定的

存储器还是算盘珠

输入设备是人的手指

输出设备还是算盘珠

未来的计算机会不会不是由这五大部件构成的

比如说运算设备和输入设备进行统一

运算设备和控制设备啊进行统一

第二个指令和数据是以同等地位存放在存储器当中的

混合存储指令和数据不加以区分

那我们可不可以把指令和数据存放在不同的存储器当中

实际上是可以的

指令和数据用二进制表示

指令由操作码和地址码构成

操作码的功能是指出具体要做什么操作

那实际上在操作码的编码过程当中

还可以利用操作码来指出寻址方式

还可以用操作码来指出参加运算的数据是定点数还是浮点数

参加运算的数据它的长度是多少，它的基值是多少，都可以用操作码来进行标识

是以运算器为中心

可不可以以其他的部件为中心

冯诺依曼结构的机器硬件部分被分成了五大块而且是以运算器为中心的我们就可以画出冯诺依曼结构硬件它的框图

![image-20230701155448331](..\images\image-20230701155448331.png)

核心就是我们这个运算器

为中心是什么含义我们可以看到我们的输入设备想输入数据的话要通过运算器啊把它放到存储器当中我们的输出设备想完成数据的输出的话也要通过存储器再经过运算器把我们的处理结果进行输出那么这就是以运算器为核心

黑色的实线表示数据通路数据通过这些线进行流动

虚线表示控制和状态反馈

我们可以看到存储器的内容可以送到控制器哪些内容要送到控制器呢举一个例子我们要执行一条指令那这条指令从存储器当中取出来那就要送到控制器当中进行分析

我们的运算器要想进行运算的话也要把信息从存储器当中取出送入运算器然后再把计算的结果保存到运算器当中去

几大组成部分的功能核心是运算器那这个核心就是为了完成算术运算和逻辑运算

然后是存储器存放数据和程序，存放在存储器当中

控制器指挥控制程序的运行完成一条指令的执行完成指令之间先后顺序的控制都是由控制器来做的

输入设备我们人能够认识的信息把它转化成机器能够识别的形式然后通过运算器把它保存到存储器当中去

输出设备它的作用和输入设备正好相反把计算机的处理结果转化成人们熟悉的形式让人们能够识别

这个机器存在什么问题这台机器以运算器为核心数据的输入输出必须要经过运算器运算器是这个系统当中非常繁忙的部分算术逻辑运算都要通过运算器来做那么还要做数据的输入和数据的输出那么运算器会非常的繁忙运算器也会成为计算机系统的瓶颈

## 第五节摘要

冯诺依曼结构有两个问题

第一个问题

以运算器为中心导致运算器成为这个系统的瓶颈

第二个问题

不具有层次化的特征

如何对这个结构进行改进

那我们是否可以进一步的

把这个硬件框图与自顶向下的方式

我们进行结构化的分析

第一我们的改进

是把原来以运算器为中心的机器

把它改进成以存储器为中心的机器

实现输入，输出设备和存储器之间直接的信息交换

那么这是我们这个结构的框图

![image-20230701162324378](..\images\image-20230701162324378.png)

存储器是核心

数据通过输入设备或者是程序

通过输入设备

可以直接把它保存在存储器当中

运算器所需要的数据可以来自于存储器

那么同样运算器运算的结果

也可以保存到存储器当中

如果要进行输出的话

存储器当中的这个数据

可以直接送到输出设备控制器

控制器通过控制信号和状态反馈信号

对整个系统进行控制

或者感知系统的各个部分的状态

那这是我们的第一个改进

可是这个图看上去还是比较乱

继续对这个图进行改进

前面介绍的过程当中

我们把计算机分成了五大部分

运算器就是 ALU

CU 是控制的缩写

ALU 和 CU 构成了我们的 CPU

存储器又被分成了两部分

主存和辅存

主存和 cpu 一起构成了的主机

输入设备和输出设备加上辅助存储器

这三部分是我们的 i\o 设备

那么主机和 io 设备一起构成了我们的计算机系统的硬件

![image-20230701162343369](..\images\image-20230701162343369.png)

那么从这个分析过程当中

我们可以看出

实际上我们可以用一种层次化的这种结构

来表述现代计算机系统它的硬件结构

第二种应对系统复杂性的方法

把第二种方法简称为三 Y

第一个 Y 是层次化

那第一个 y 就是层次化这个单词

把被设计的系统给它划分成多个模块

或者是子模块

然后

我们分别对模块或者是子模块进行设计

还可以对模块和子模块

进行进一步的细化

并且递归这个过程

那么使问题从一个非常大的

难以解决的问题

逐渐的细化成小的容易解决的问题

当然仅仅层次化是不够的

为什么

我们设计出来的结构

简单的小的模块要能够组装在一起

才会形成更大的模块

那么要想能够组装在一起的话

我们必须要解决接口的问题

那个这个就是我们第二个 Y 就是模块化

模块化就是要有明确定义的功能和接口

每个模块都要有明确定义的功能和接口

只有功能和接口定义好了

那么设计出来的子模块

子子模块才能够组装在一起

形成更大的模块

进而形成更大的系统

第三个 Y 是规则性

规则性的目的是使模块更容易被重用

比如说我们在模块划分的过程当中

模块的接口和功能的定义满足工业标准或者是国际标准

这样的话

我们设计出的模块

不仅仅在我们设计的这个系统上能用

放到其他系统上也能用

那么现代计算机的设计当中非常重视这一点

比较典型的

比如我们现在计算机系统当中的这个内存

那不管你买哪家生产商生产的机器

只要它这个机器和内存的接口是标准化的

那么任何一个厂家生产的内存

你买过来都可以插在你的机器上

使你的计算机的性能存储容量得到扩展

那么这种方式也细化了计算机产业的分工

一个企业你可以只关心计算机系统当中

一个部件的生产而不用生产整台机器

## 第六节摘要

下面通过让计算机去执行一个程序的方式对这个框图进行细化计算机在执行一个程序或者是解释一条指令的过程当中到底需要哪些功能解决哪些问题然后根据这些问题对框图进行进一步的细化

第一个问题一个现实当中的问题如何用计算机来解决那么看见这个问题你会想什么呢对于我来说想到的第一个问题应该是：这个问题能不能用计算机来解决有些问题可以用计算机来解决有些问题是不能用计算机来解决的可以查阅一下关于可计算性理论的一些知识那么可计算性理论是研究计算的可行性和函数算法的理论， 又称为算法理论假设说函数的定义域是 d 值域是 r 如果存在一种算法对 d 当中任意一个给定的 x，都能够计算出 f(x)的值那称这个函数就是可计算的那么可计算性通常是指一类问题是否可以用计算机来解决

比如说煎鸡蛋，那这个问题就没法用计算机来直接进行解决不可计算问题当中非常著名的一个就是图灵机停机问题那也就是说是否存在一台万能的图灵机 h 把任意一个图灵机 m，我们把它输入到 h 当中它都能判定 m 最终是否能停机并且给出一个明确的答案是或者不是

假设后面举的例子不涉及到这个问题后边举的例子是可以计算的现在我们假设我们面对的是一个可以用计算机来解决的问题那么如何用计算机来解决这个问题那么可能看见这个问题大家首先想到的就是编写程序那么实际上并不是这样的要想用计算机来解决一个问题我们首先要做一些上机前的准备比如说要建立数学模型

现在假如要解决的问题计算正弦交流电它的实时电压那我们首先就要给出数学模型数学模型就是这样进行表述的

![image-20230701211846063](..\images\image-20230701211846063.png)

有这个数学模型我们就可以计算出任意一个时刻正弦交流电的电压可是对这样的一个数学模型来说几乎现在所有的计算机在指令集当中都没有明确的给出这个公式怎么进行计算指令集当中不会提供这样的一条指令直接使用这样一条指令就可以计算

那也就是说给出模型之后我们要确定计算方法

比如说计算 sinx 我们就可以用下面这个公式进行计算

![image-20230701211857876](..\images\image-20230701211857876.png)

计算根号 x 也可以用下面的这个公式来进行计算

![image-20230701211912257](..\images\image-20230701211912257.png)

那什么时候结束？直到相邻两次的计算结果之间的差值满足了用户的精度要求那我们的运算就可以停止了

那么经过建立数学模型经过确定计算方法就可以编程序了

程序是什么是运算所需要的全部的步骤程序是由指令构成的每一个指令对应了其中的一个步骤

实际上在前面讲机器层次结构的时候，每一个指令可以再细分为多个微指令那这些微步骤我们可以用微指令来进行表述程序在系统上要进行有序的执行

假如说我们需要一个程序来计算下面这个方程式：

![image-20230701212158405](..\images\image-20230701212158405.png)

那么首先对我们面对的这台计算机将要用于编程的计算机做一个假设假设这台机器是一个累加器型的机器，也就是说在计算在运行加减乘除操作的时候参与运算的操作数有两个其中的一个操作数要把它保存在累加器当中另外的一个操作数呢来自于计算机的主存储器从我们要计算的这个问题来看，需要包含的指令种类有：

- 加法指令
- 乘法指令
- 加载数据指令（从内存中加载数据到寄存器中）
- 存储数据指令（从寄存器中存储数据到内存中）
- 打印指令
- 停机指令

在我们前面假设的这个条件下如何来编写这个程序我们现在假设 a,b，c 还有 x 这些操作数已经保存到了内存当中如果要完成这样运算的话首先可以把 x 取到运算器当中实际上我们是把 x 保存在运算器中的累加器里面累加器是一个寄存器然后做乘法操作把内存当中的一个数据和累加器当中的数据做乘法经过这两步操作我们就计算出了 x 的平方并且 x 的平方是保存在累加器 acc 当中的然后再给这个 x 平方再乘上 a 依然用一条乘法指令来做这条指令执行完以后在累加器当中保存的就是 ax 的平方

接下来计算 b\*x，依然要使用累加器所以在这儿要把累加器当中已经保存的 ax 的平方要把它转存到内存单元当中去那这样的话我们就需要一个存储指令这叫存数指令把 ax 的平方保存到了给定的存储器当中

然后我们再计算这个 b\*x 同样我们还是需要把其中的一个操作数从内存单元当中取出放到累加器当中那这个数据可以是 b 也可以是 x 这个例子当中给出来的是把 b 取到了运算器当中也就是放到了运算器的累加器的里面然后我们再做乘法操作把内存单元当中的数和 acc 这个寄存器当中的数做乘法利用乘法指令来做那这个时候 acc 当中保存的就是 b 乘以 x 然后我们就可以做加法了把 b 乘以 x 这个值再加上 ax 的平方 ax 的平方现在是保存在内存单元当中的那我们完成加法指令

再用加法指令完成 a\*x^2+b\*x+c

一共用了八条指令

完成了这个操作好了

这个算法好不好实际上呢我们完全可以用另外的一种方法来实现 ax 平方加上 bx 加 c 要比我们现在的这种方法要简洁比如说把我们要计算的问题稍微做一个转化把它变成 ax 加 b 括号乘以 x 加 c 那么首先要做的还是把 x 取出来放到 acc 这个寄存器当中然后用一个乘法操作把内存单元当中保存的 a 和 acc 当中保存的 x 做乘法运算结果依然保存在 acc 当中然后再做一个加法运算把 acc 当中保存的 ax 和内存单元当中保存的 b 相加

之后我们再做一个乘法运算把 acc 当中现在保存的 ax 加 b 和内存单元当中保存的 x 啊做一个乘法之后我们再做一次加法运算就得到了这个结果我们可以看到现在用五条指令就完成了原来用八条指令才能完成的功能

![image-20230701213455646](..\images\image-20230701213455646.png)

那这是我们在算法上做的一个改进如果我们用左边的这种方法来做啊左边的这种方法来做指令的条数比较多预算起来的话比右侧的这个程序要慢在同一台计算机上进行执行的话另外左侧这个程序需要的存储空间也更大

为了解决这个问题给出了每一个动作那么下面我们要把这个动作用指令的方式进行表述

那么首先我们对**指令格式**进行举例假设我们现在要做取数操作或者第一条指令是我们的取数指令取数指令的作用是把内存单元阿尔法当中保存的数据给它保存在 acc 当中操作数只有一个，就是阿尔法 acc 是默认，不需要指令当中指出那这样的话我们就可以假设指令一共有 16 位其中的六位是操作码部分指明了要做什么样的操作

还有呢就是我们的加法操作在我们给出的模型机当中我们假设另外的一个操作数呢是默认的保存在了 acc 里面所以呢加法操作我们也只需要一个操作数加法的结果也默认的保存在 aacc 当中那它的功能就是把 acc 的内容和内存单元 r 当中的内容相加结果保存在 acc 当中然后是我们的乘法操作被乘数默认保存在 acc 当中并且成的结果也保存在 acc 当中那么乘法操作呢就完成这样的一个功能我们外面给出来的这个方括号是指寄存器当中保存的内容内存单元当中保存的内容那么另外呢我们还有打印操作把内存单元当中的数据我们把它送给打印机还有停机操作

那么六条指令可以分别进行编码然后操作码部分可以分别进行编码地址码部分根据操作数所在的实际的物理地址来写虽然没有把每一条指令它操作码部分和地址码部分用二进制的方式都给出来但是每一条指令都是二进制进行表示的

![image-20230701214109219](..\images\image-20230701214109219.png)

我们有几条指令是存在一些问题的乘法指令假如说我们寄存器的长度都是相等的和内存单元里面保存的二进制数的位数是相等的那 acc 如果是八位，内存单元的位数也是八位的话那我们乘法的这个结果只要比八位要长比如说简单的啊十进制的乘法 80x80 得 6400 那么我们用一个八位的一个寄存器来保存乘法的结果 16 位的结果是保存不下的，所以这个我们没考虑这个细节

那么有了这个指令集我们就可以写出我们计算 ax 方加 bx 加 c 这个计算任务它的程序清单以表格的形式给出来的那么表格的中间这一部分就是保存在内存单元当中的数据和指令

![image-20230701214330271](..\images\image-20230701214330271.png)

内存单元当中的 07 保存的是指令指令分成了操作码和地址码两部分指令呢是由二进制数来表示的那么实际上后面从第八个存储单元开始一直到第 11 个存储单元我们保存了 xabc 这些原始数据也是用二进制数来表示的另外我们保存的这个结果程序执行完结果保存在第 12 个存储单元当中结果也是用二进制数来表示的那么从这儿呢我们也能看到冯诺依曼机器结构的这个特征指令和数据以同等的地位保存在存储器当中指令和数据都是二进制程序清单有了

下一步的操作就是要把指令和数据给它保存到内存单元当中采用存储程序的方式保存在存储器里面系统才能够执行这些指令

所以存储器的功能是用来保存指令数据或者是其他信息的那么要完成这样的功能存储器的结构是什么样的呢如何进行访问呢每次访问获得的数据的位数又是多少呢

## 第七节摘要

存储器的基本组成指令和数据保存在存储器当中因此存储器它的核心结构就是一个存储体这个存储体要能够保存指令和数据同时还要对这个存储体能够进行访问每次取指令我要能够把这条指令要能够取出来取数据要把数据能够取出来那么存储体就是我们这个整体的结构

存储体又由若干个存储单元构成指令的操作码和地址码两部分就存放在存储单元当中所以存储单元是一个电子设备存储单元又有多个存储元件构成如果我们进行一个类比的话那一个存储体就相当于一个大楼存储单元相当于大楼里面的每一个房间

要找到房间里的人那么就要有房间的这个编号那么一个房间里面可能有多个人有点相当于我们的这个床位每个床位有人或者是没有人用它来表示零或者是一那么存储单元存放了一串的二进制代码我们的指令和数据实际上都是存放在存储单元当中的那我们把存储单元里面存放的这些二进制代码的组合我们就把它称为存储字

还有一个概念是存储字长就是我们存储字的长度存储单元当中二进制代码的位数我们把它称为存储字长

那么每一个存储单元我们可以给它一个地址那么一个存储单元当中存放了一个存储字我们就可以通过这个地址对存储单元进行访问

要取一条指令就可以给出这条指令的地址把这条指令从存储体当中取出来放到 cpu 当中去执行存储单元是按地址进行寻址的

![image-20230701215533519](..\images\image-20230701215533519.png)

除了这个存储体之外还有两个方块一个是 mar 一个是 mdr

这个存储体包含了若干个存储单元对存储单元的访问我们要按地址进行访问 cpu 想取指令想取操作数首先要给出存储单元的地址那么 mar 就是一个寄存器这个寄存器的名字把它叫做存储器地址寄存器从这个名字上其实我们就能看出 mar m 是存储器的缩写 a 是地址的缩写 r 是寄存器的缩写这个里面保存了存储单元的地址或者是存储单元的编号

那 mar 的位数和什么有关呢实际上它和存储单元的个数有关比如一个大楼 100 个房间我们从 0 号给这个房间进行编制的话如果十进制编制两位就够了从零开始编制一直到 99 啊 100 个房间就够了那么房间的地址就保存在 ma2 当中所以如果是对这 100 个房间我们用十进制数进行编制的话两位就可以了

但是在计算机当中呢不仅是程序数据用二进制数表示这个 mar 里面保存的这个地址也是二进制数另外就是 mdr 保存了要送入到 cpu 当中的数据或者是要 mdr 保存的要保存到存储体当中的数据或者是刚刚从存储体当中取出来的这部分数据因此这个寄存器的长度和存储单元的长度是相同的 mdr 称为存储器数据寄存器，反映了存储字长

![image-20230701220003561](..\images\image-20230701220003561.png)

## 第八节摘要

运算器的结构是什么运算器是怎么进行工作的做加法怎么做做乘法怎么做根据运算器这些功能我们来确定运算器的基本结构那这个基本结构的核心我们进一步的假设我们的模型机有三个寄存器一个寄存器就是我们前面讲到的这个累加器那么累加器保存了其中的一个操作数和运算的这个结果
